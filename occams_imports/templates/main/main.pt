<html metal:use-macro="load: ../master.pt">
  <metal:content-slot fill-slot="content-slot">
  <div id="view-mappings" style="display: none;" data-bind="visible: isReady">
  <br />
  <header class="page-header">
    <div class="pull-right">
      <div class="btn-group">
        <button type="button"
                class="btn pull-right btn-default dropdown-toggle "
                data-toggle="dropdown">
          <span class="glyphicon glyphicon-plus"></span>
          <span>Mapping</span>
        </button>
        <ul class="dropdown-menu">
          <li><a href="${request.route_path('imports.mappings.direct')}">Direct</a></li>
          <li><a href="${request.route_path('imports.mappings.imputation')}">Imputation</a></li>
        </ul>
      </div> <!-- btn-group-->
    </div> <!-- pull-right-->
    <h1 i18n:translate="">Mapped Variables</h1>
  </header>
  <p>
    <span>Showing</span>
    <strong><span data-bind="text: numOfMappings"></span></strong>
    <span>mappings</span>
  </p>
  <div data-bind="css: { 'alert': true, 'alert-success': isSuccess, 'alert-info': isInfo }">
    <strong data-bind="text: msgType"></strong>
    <span data-bind="text: msg"></span>
  </div>
    <table class="table table-hover">
      <thead>
        <tr>
          <th></th>
          <th>DRSC Form</th>
          <th>DRSC Variable</th>
          <th>Site Form</th>
          <th>Site Variable</th>
          <th>Date Mapped</th>
          <th>View</th>
        </tr>
      </thead>
      <tbody data-bind="foreach: mapped">
        <tr>
          <td><input type="checkbox"
                     data-bind="checked: deleteRow"
                     value=""></td>
          <td data-bind="text: drsc_form"></td>
          <td><code data-bind="text: drsc_variable"></code></td>
          <td data-bind="text: site_form"></td>
          <td><code data-bind="text: site_variable"></code></td>
          <td data-bind="text: date_mapped"></td>
          <td><a data-bind="attr: { href: url }">
                <span class="fa fa-chevron-right"></span>
              </a></td>
        </tr>
      </tbody>
    </table>
    <br />
    <div id="delete_button"
         style="display: none;"
         data-bind="visible: isChecked">
      <button class="btn btn-default btn-lg"
              type="button"
              data-bind="click: deleteRows">
        <span class="glyphicon glyphicon-trash"></span>
        <span>Delete Selected</span>
      </button>
    </div>
  </div>

  </metal:content-slot>

  <metal:javascript-slot fill-slot="javascript-extras-slot">
    <script type="text/javascript">
      $(function(){
        'use strict';
        ko.applyBindings(new formListViewModel());
      });
    </script>
  </metal:javascript-slot>

</html>
